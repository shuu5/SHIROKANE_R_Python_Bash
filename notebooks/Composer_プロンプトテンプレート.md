# SHIROKANE R/Python/Bash Composerプロンプトテンプレート

#SHIROKANE #スパコン #プロンプトテンプレート #rules_for_ai #composer #cursor #R #Python #Bash #生物情報学 #ワークフロー

このドキュメントには、SHIROKANE上でR、Python、Bashを使用した生物情報学解析を効率的に実行するためのComposeプロンプトテンプレートが含まれています。

## 1. ジョブスクリプト作成テンプレート

```text
# Prompt: SHIROKANEジョブスクリプト作成

このプロンプトを使用して、SHIROKANE上で[言語名]スクリプトを実行するためのジョブスクリプトを作成してください。

## 実行する処理の概要
[実行したい処理の詳細を記述します]

## 言語と環境
- 主言語: [R/Python/Bash]
- バージョン: [言語バージョン]
- 必要なモジュール: [moduleコマンドでロードする必要のあるモジュール]

## リソース要件
- メモリ: [必要なメモリ量、例: 8G]
- CPUコア数: [必要なコア数、例: 4]
- 実行時間の見積もり: [予想される実行時間]

## 入力データ
- 形式: [データの形式、例: CSV, FASTQ]
- サイズ: [データサイズの概算]
- 場所: [データの配置場所]

## 出力先
- 形式: [出力ファイル形式]
- 場所: [出力先ディレクトリ]

## 特記事項
[エラー処理や特別な要件があれば記述]
```

## 2. R言語解析スクリプト作成テンプレート

```text
# Prompt: SHIROKANE R解析スクリプト作成

以下の指示に基づいて、SHIROKANE上で実行するためのR解析スクリプトを作成してください。コマンドラインから実行可能で、適切なエラーハンドリングを備えたものが望ましいです。

## 解析タスクの概要
[解析タスクの詳細な説明]

## 入力データの詳細
- ファイル形式: [CSV/TSV/RDSなど]
- データ構造: [行数、列数、主要な変数など]
- 前処理の必要性: [はい/いいえ、どのような前処理か]

## 使用するパッケージ
- 統計解析: [例: DESeq2, edgeR, limma]
- データ操作: [例: data.table, dplyr, tidyr]
- 可視化: [例: ggplot2, plotly, pheatmap]
- その他: [例: parallel, BiocParallel]

## 実装すべき機能
1. [機能1の詳細]
2. [機能2の詳細]
3. [機能3の詳細]

## 出力要件
- 主要な出力ファイル: [ファイル形式と内容]
- ログ: [必要なログ情報]
- 可視化出力: [グラフ等の仕様]

## 並列処理
- 並列化すべき部分: [並列化したい処理]
- SHIROKANEでの実行を想定した並列処理の実装方法

## コード形式
- コマンドライン引数対応: [必要な引数]
- エラーハンドリング方針: [どのようなエラー処理が必要か]
- コーディングスタイル: [tidyverseなど]
```

## 3. Python解析スクリプト作成テンプレート

```text
# Prompt: SHIROKANE Python解析スクリプト作成

以下の指示に基づいて、SHIROKANE上で実行するためのPython解析スクリプトを作成してください。コマンドライン引数をサポートし、適切なロギングとエラーハンドリングを含めてください。

## 解析タスクの概要
[解析タスクの詳細な説明]

## 入力データの詳細
- ファイル形式: [CSV/TSV/FASTQ/BAMなど]
- データ構造: [行数、列数、主要な変数など]
- 前処理の必要性: [はい/いいえ、どのような前処理か]

## 使用するライブラリ
- データ処理: [例: pandas, numpy, scipy]
- 機械学習: [例: scikit-learn, tensorflow, pytorch]
- バイオインフォマティクス: [例: biopython, pysam]
- 可視化: [例: matplotlib, seaborn, plotly]
- 並列処理: [例: multiprocessing, joblib, dask]

## 実装すべき機能
1. [機能1の詳細]
2. [機能2の詳細]
3. [機能3の詳細]

## 出力要件
- 主要な出力ファイル: [ファイル形式と内容]
- ログ: [必要なログ情報]
- 可視化出力: [グラフ等の仕様]

## メモリと計算効率
- 大規模データ処理方針: [チャンク処理、ストリーミングなど]
- メモリ最適化テクニック: [必要な場合]

## コード形式
- コマンドライン引数パーサー: [argparse/click/fireなど]
- エラーハンドリング方針: [例外処理の詳細]
- コーディングスタイル: [PEP 8など]
```

## 4. 複合言語ワークフロー作成テンプレート

```text
# Prompt: SHIROKANE複合言語ワークフロー設計

以下の指示に基づいて、SHIROKANE上でR、Python、Bashを組み合わせたワークフローを設計してください。各ステップで最適な言語を使用し、ステップ間のデータ交換も考慮してください。

## ワークフローの目的
[ワークフロー全体の目的と期待される成果]

## 処理ステップと使用言語
1. ステップ1: [説明] - 使用言語: [R/Python/Bash]
2. ステップ2: [説明] - 使用言語: [R/Python/Bash]
3. ステップ3: [説明] - 使用言語: [R/Python/Bash]
...

## 入出力データフロー
- ステップ間のデータ受け渡し形式: [CSV/JSON/RDS/etc]
- 中間ファイルの扱い: [保存場所、命名規則など]

## リソース要件
- 各ステップのメモリ要件: [ステップごとに記載]
- 並列処理: [どのステップで並列処理を行うか]

## エラーハンドリングと回復戦略
- エラー検出方法: [終了コードのチェックなど]
- 失敗したジョブの再実行方針: [必要に応じて]

## ジョブ管理
- ジョブの依存関係: [どのステップが他のステップの完了を待つか]
- ジョブチェーンの実装方法: [qsubの-hold_jidオプションなど]

## モニタリングとログ
- 進捗状況の追跡方法: [ログファイル、ステータスファイルなど]
- 問題診断のためのログ戦略: [各言語でのロギング方法]
```

## 5. SHIROKANEリソース最適化テンプレート

```text
# Prompt: SHIROKANEリソース最適化

以下のコードとワークフローを、SHIROKANEスーパーコンピュータ上で効率的に実行できるよう最適化してください。

## 現在のコードまたはワークフロー
```
[現在のコードやワークフローをここに貼り付ける]
```

## 最適化の目的
[実行時間の短縮/メモリ使用量の削減/スケーラビリティの向上など]

## 現在の実行状況と問題点
- 実行時間: [現在の実行時間]
- メモリ使用量: [現在のメモリ使用量]
- ボトルネック: [特定されている場合]

## リソース情報
- 利用可能なコア数: [例: 24コア]
- 利用可能なメモリ: [例: 128GB]
- ストレージタイプと容量: [例: 高速ストレージ1TB]

## 期待される改善点
[具体的にどのような改善を期待するか]
```

## 6. バイオインフォマティクスパイプライン設計テンプレート

```text
# Prompt: SHIROKANEバイオインフォマティクスパイプライン設計

以下の生物情報学解析パイプラインをSHIROKANE上で実行するためのスクリプト群とワークフローを設計してください。

## 解析タイプ
[NGSデータ解析/プロテオミクス/ゲノム解析など]

## 入力データ
- データタイプ: [WGS/WES/RNA-seq/ChIP-seqなど]
- サンプル数: [分析するサンプル数]
- 参照ゲノム: [使用する参照ゲノム]

## 解析ステップ
1. [ステップ1: 例えばQC]
2. [ステップ2: 例えばマッピング]
3. [ステップ3: 例えば変異検出]
...

## 使用するツールと言語
- ツール: [BWA/STAR/GATK/SAMtoolsなど]
- 言語: [R/Python/Bash]
- パッケージ: [BioconductorパッケージやPythonライブラリ]

## パイプライン要件
- エラー耐性: [エラーハンドリングとリカバリ方法]
- スケーラビリティ: [サンプル数増加への対応]
- 再現性: [環境管理やバージョン固定方法]

## 出力とレポート
- 結果ファイル: [生成される主要な結果ファイル]
- 品質レポート: [生成される品質管理レポート]
- 可視化: [必要なグラフや可視化]
```

## 7. マルチGPU対応スクリプト作成テンプレート

```text
# Prompt: SHIROKANE GPU計算スクリプト作成

SHIROKANEのGPUノードで実行するための、以下の要件を満たすスクリプトを作成してください。

## タスクの概要
[機械学習モデルのトレーニング/推論など]

## GPU要件
- GPU数: [必要なGPU数]
- GPUタイプ: [Tesla V100など]
- GPUメモリ: [必要なGPUメモリ]

## 使用フレームワーク
- フレームワーク: [TensorFlow/PyTorch/JAXなど]
- バージョン: [フレームワークのバージョン]

## データ
- 入力データサイズ: [処理するデータの総サイズ]
- データの読み込み方法: [バッチ処理/メモリマップなど]

## モデル詳細
- アーキテクチャ: [使用するモデルアーキテクチャ]
- パラメータ数: [モデルのパラメータ数]

## 分散学習戦略
- 分散戦略: [DataParallel/DistributedDataParallelなど]
- GPU間通信: [NCCLなど]

## 出力と保存
- チェックポイント: [モデル保存頻度と方法]
- ログ: [必要なログ情報]
```

## 8. エラーハンドリングとデバッグテンプレート

```text
# Prompt: SHIROKANEエラー解決

SHIROKANEで実行中に以下のエラーが発生しました。原因を診断し、解決策を提案してください。

## エラーメッセージ
```
[エラーメッセージをここに貼り付け]
```

## 実行環境
- ノードタイプ: [計算ノード/GPUノードなど]
- ジョブクラス: [使用しているジョブクラス]
- メモリ割り当て: [s_vmemとmem_reqの設定]

## 実行しているコード
```
[問題のコードスニペットをここに貼り付け]
```

## これまでの試行
[既に試した解決策があれば記述]

## 追加情報
[関連する設定や環境情報]
```

## 9. R/Python/Bash連携スクリプト作成テンプレート

```text
# Prompt: R/Python/Bash連携スクリプト作成

SHIROKANEで実行するための、R、Python、Bashを連携させたスクリプトを作成してください。各言語の強みを活かした設計にしてください。

## タスクの概要
[解決したい問題の詳細]

## 言語ごとの役割
- Bash: [データ取得、前処理、ワークフロー管理など]
- Python: [データ処理、機械学習、特徴抽出など]
- R: [統計解析、可視化、レポート生成など]

## 言語間データ交換
- 形式: [CSV/TSV/JSON/SQLiteなど]
- 交換ポイント: [どのタイミングでどのデータを交換するか]

## 処理フロー
1. [ステップ1: 使用言語と処理内容]
2. [ステップ2: 使用言語と処理内容]
3. [ステップ3: 使用言語と処理内容]
...

## インターフェース要件
- Python-R連携: [reticulateまたはrpy2]
- コマンドライン引数: [全体のワークフローを制御する引数]

## エラー処理戦略
- 各言語でのエラーハンドリング
- ワークフロー全体の整合性チェック
```

## 10. 大規模データ処理最適化テンプレート

```text
# Prompt: SHIROKANE大規模データ処理最適化

SHIROKANEで大規模なデータセットを効率的に処理するためのスクリプトを設計・最適化してください。

## データ詳細
- サイズ: [データの総サイズ]
- 形式: [ファイル形式]
- 構造: [行数、列数、データ構造]

## 処理タスク
[データに対して実行したい処理の詳細]

## 現在の課題
- メモリ制限: [利用可能なメモリ]
- 処理時間: [許容される処理時間]
- スケーラビリティ: [将来的なデータサイズの増加予測]

## 希望する最適化アプローチ
- チャンク処理: [データをチャンクに分割して処理]
- 並列処理: [並列処理の方法]
- 分散処理: [複数ノードでの処理方法]
- メモリマッピング: [ディスクベースの処理方法]

## 使用言語とライブラリ
- 言語: [R/Python/他]
- ライブラリ: [data.table/dask/sparkなど]

## 出力要件
- 形式: [出力ファイル形式]
- 統合方法: [チャンク処理した結果の統合方法]
``` 